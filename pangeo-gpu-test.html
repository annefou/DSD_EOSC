

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Penguins example &#8212; Unlocking the Power of EOSC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pangeo-gpu-test';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Try it out yourself" href="exercises.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Unlocking the Power of EOSC - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Unlocking the Power of EOSC - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to “Unlocking the Power of EOSC - Navigating Services for Research Visibility and Impact”
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="coc.html">Code of Conduct and community participation guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="agenda.html">Agenda for the session</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">The European Open Science Cloud (EOSC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="fair_os.html">FAIR and Open Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="current.html">Discussion on current working practices and bottlenecks</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples of services to realize Open Science in practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Getting started with EOSC</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercises.html">Try it out yourself</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Penguins example</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/annefou/DSD_EOSC" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/annefou/DSD_EOSC/issues/new?title=Issue%20on%20page%20%2Fpangeo-gpu-test.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/pangeo-gpu-test.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Penguins example</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-use-the-penguin-dataset-to-train-a-neural-network-which-can-classify-which-species-a-penguin-belongs-to-based-on-their-physical-characteristics">¶We will use the penguin dataset to train a neural network which can classify which species a penguin belongs to, based on their physical characteristics.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspired-from-https-carpentries-incubator-github-io-deep-learning-intro-02-keras-index-html-and-https-github-com-mcnakhaee-palmerpenguins">(inspired from https://carpentries-incubator.github.io/deep-learning-intro/02-keras/index.html and https://github.com/mcnakhaee/palmerpenguins)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="penguins-example">
<h1>Penguins example<a class="headerlink" href="#penguins-example" title="Permalink to this heading">#</a></h1>
<section id="we-will-use-the-penguin-dataset-to-train-a-neural-network-which-can-classify-which-species-a-penguin-belongs-to-based-on-their-physical-characteristics">
<h2>¶We will use the penguin dataset to train a neural network which can classify which species a penguin belongs to, based on their physical characteristics.<a class="headerlink" href="#we-will-use-the-penguin-dataset-to-train-a-neural-network-which-can-classify-which-species-a-penguin-belongs-to-based-on-their-physical-characteristics" title="Permalink to this heading">#</a></h2>
</section>
<section id="inspired-from-https-carpentries-incubator-github-io-deep-learning-intro-02-keras-index-html-and-https-github-com-mcnakhaee-palmerpenguins">
<h2>(inspired from <a class="reference external" href="https://carpentries-incubator.github.io/deep-learning-intro/02-keras/index.html">https://carpentries-incubator.github.io/deep-learning-intro/02-keras/index.html</a> and <a class="github reference external" href="https://github.com/mcnakhaee/palmerpenguins">mcnakhaee/palmerpenguins</a>)<a class="headerlink" href="#inspired-from-https-carpentries-incubator-github-io-deep-learning-intro-02-keras-index-html-and-https-github-com-mcnakhaee-palmerpenguins" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">palmerpenguins</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting palmerpenguins
  Downloading palmerpenguins-0.1.4-py3-none-any.whl (17 kB)
Requirement already satisfied: pandas in /srv/conda/envs/notebook/lib/python3.11/site-packages (from palmerpenguins) (2.1.4)
Requirement already satisfied: numpy in /srv/conda/envs/notebook/lib/python3.11/site-packages (from palmerpenguins) (1.26.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /srv/conda/envs/notebook/lib/python3.11/site-packages (from pandas-&gt;palmerpenguins) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /srv/conda/envs/notebook/lib/python3.11/site-packages (from pandas-&gt;palmerpenguins) (2023.3.post1)
Requirement already satisfied: tzdata&gt;=2022.1 in /srv/conda/envs/notebook/lib/python3.11/site-packages (from pandas-&gt;palmerpenguins) (2023.3)
Requirement already satisfied: six&gt;=1.5 in /srv/conda/envs/notebook/lib/python3.11/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas-&gt;palmerpenguins) (1.16.0)
Installing collected packages: palmerpenguins
Successfully installed palmerpenguins-0.1.4
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> 
<span class="kn">from</span> <span class="nn">palmerpenguins</span> <span class="kn">import</span> <span class="n">load_penguins</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span> <span class="o">=</span> <span class="n">load_penguins</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">penguins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>342.000000</td>
      <td>342.000000</td>
      <td>342.000000</td>
      <td>342.000000</td>
      <td>344.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>43.921930</td>
      <td>17.151170</td>
      <td>200.915205</td>
      <td>4201.754386</td>
      <td>2008.029070</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.459584</td>
      <td>1.974793</td>
      <td>14.061714</td>
      <td>801.954536</td>
      <td>0.818356</td>
    </tr>
    <tr>
      <th>min</th>
      <td>32.100000</td>
      <td>13.100000</td>
      <td>172.000000</td>
      <td>2700.000000</td>
      <td>2007.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>39.225000</td>
      <td>15.600000</td>
      <td>190.000000</td>
      <td>3550.000000</td>
      <td>2007.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>44.450000</td>
      <td>17.300000</td>
      <td>197.000000</td>
      <td>4050.000000</td>
      <td>2008.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>48.500000</td>
      <td>18.700000</td>
      <td>213.000000</td>
      <td>4750.000000</td>
      <td>2009.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>59.600000</td>
      <td>21.500000</td>
      <td>231.000000</td>
      <td>6300.000000</td>
      <td>2009.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Adelie&#39;, &#39;Gentoo&#39;, &#39;Chinstrap&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count        344
unique         3
top       Adelie
freq         152
Name: species, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7f1edc44e850&gt;
</pre></div>
</div>
<img alt="_images/de407d08e3cbac9a0ff7b4ba1b6c5e34cb159a9340fe117bf3692ce18d9190c7.png" src="_images/de407d08e3cbac9a0ff7b4ba1b6c5e34cb159a9340fe117bf3692ce18d9190c7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop two columns and the rows that have NaN values in them</span>
<span class="n">penguins_filtered</span> <span class="o">=</span> <span class="n">penguins</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;island&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">penguins_filtered</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Chinstrap</td>
      <td>55.8</td>
      <td>19.8</td>
      <td>207.0</td>
      <td>4000.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Chinstrap</td>
      <td>43.5</td>
      <td>18.1</td>
      <td>202.0</td>
      <td>3400.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Chinstrap</td>
      <td>49.6</td>
      <td>18.2</td>
      <td>193.0</td>
      <td>3775.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Chinstrap</td>
      <td>50.8</td>
      <td>19.0</td>
      <td>210.0</td>
      <td>4100.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Chinstrap</td>
      <td>50.2</td>
      <td>18.7</td>
      <td>198.0</td>
      <td>3775.0</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
<p>342 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract columns corresponding to features</span>
<span class="n">penguins_features</span> <span class="o">=</span> <span class="n">penguins_filtered</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
<span class="n">penguins_features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>39.3</td>
      <td>20.6</td>
      <td>190.0</td>
      <td>3650.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>55.8</td>
      <td>19.8</td>
      <td>207.0</td>
      <td>4000.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>340</th>
      <td>43.5</td>
      <td>18.1</td>
      <td>202.0</td>
      <td>3400.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>341</th>
      <td>49.6</td>
      <td>18.2</td>
      <td>193.0</td>
      <td>3775.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>342</th>
      <td>50.8</td>
      <td>19.0</td>
      <td>210.0</td>
      <td>4100.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>343</th>
      <td>50.2</td>
      <td>18.7</td>
      <td>198.0</td>
      <td>3775.0</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
<p>342 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">penguins_filtered</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
<span class="n">target</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># print out the top 5 to see what it looks like.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Adelie</th>
      <th>Chinstrap</th>
      <th>Gentoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">penguins_features</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>245</th>
      <td>49.5</td>
      <td>16.1</td>
      <td>224.0</td>
      <td>5650.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>338</th>
      <td>45.7</td>
      <td>17.0</td>
      <td>195.0</td>
      <td>3650.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>89</th>
      <td>38.9</td>
      <td>18.8</td>
      <td>190.0</td>
      <td>3600.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>262</th>
      <td>50.5</td>
      <td>15.2</td>
      <td>216.0</td>
      <td>5000.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>48</th>
      <td>36.0</td>
      <td>17.9</td>
      <td>190.0</td>
      <td>3450.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>285</th>
      <td>51.3</td>
      <td>19.9</td>
      <td>198.0</td>
      <td>3700.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>268</th>
      <td>44.5</td>
      <td>15.7</td>
      <td>217.0</td>
      <td>4875.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>218</th>
      <td>46.2</td>
      <td>14.4</td>
      <td>214.0</td>
      <td>4650.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>234</th>
      <td>47.4</td>
      <td>14.6</td>
      <td>212.0</td>
      <td>4725.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>187</th>
      <td>48.4</td>
      <td>16.3</td>
      <td>220.0</td>
      <td>5400.0</td>
      <td>2008</td>
    </tr>
  </tbody>
</table>
<p>307 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>333</th>
      <td>49.3</td>
      <td>19.9</td>
      <td>203.0</td>
      <td>4050.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>112</th>
      <td>39.7</td>
      <td>17.7</td>
      <td>193.0</td>
      <td>3200.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>239</th>
      <td>51.3</td>
      <td>14.2</td>
      <td>218.0</td>
      <td>5300.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>269</th>
      <td>48.8</td>
      <td>16.2</td>
      <td>222.0</td>
      <td>6000.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>311</th>
      <td>47.5</td>
      <td>16.8</td>
      <td>199.0</td>
      <td>3900.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>12</th>
      <td>41.1</td>
      <td>17.6</td>
      <td>182.0</td>
      <td>3200.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>219</th>
      <td>49.5</td>
      <td>16.2</td>
      <td>229.0</td>
      <td>5800.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>278</th>
      <td>51.3</td>
      <td>19.2</td>
      <td>193.0</td>
      <td>3650.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>161</th>
      <td>46.8</td>
      <td>15.4</td>
      <td>215.0</td>
      <td>5150.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>84</th>
      <td>37.3</td>
      <td>17.8</td>
      <td>191.0</td>
      <td>3350.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>173</th>
      <td>45.1</td>
      <td>14.5</td>
      <td>215.0</td>
      <td>5000.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>119</th>
      <td>41.1</td>
      <td>18.6</td>
      <td>189.0</td>
      <td>3325.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>235</th>
      <td>50.0</td>
      <td>15.9</td>
      <td>224.0</td>
      <td>5350.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>80</th>
      <td>34.6</td>
      <td>17.2</td>
      <td>189.0</td>
      <td>3200.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>42</th>
      <td>36.0</td>
      <td>18.5</td>
      <td>186.0</td>
      <td>3100.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>255</th>
      <td>49.1</td>
      <td>15.0</td>
      <td>228.0</td>
      <td>5500.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>122</th>
      <td>40.2</td>
      <td>17.0</td>
      <td>176.0</td>
      <td>3450.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>72</th>
      <td>39.6</td>
      <td>17.2</td>
      <td>196.0</td>
      <td>3550.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>14</th>
      <td>34.6</td>
      <td>21.1</td>
      <td>198.0</td>
      <td>4400.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>216</th>
      <td>45.8</td>
      <td>14.2</td>
      <td>219.0</td>
      <td>4700.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>199</th>
      <td>50.5</td>
      <td>15.9</td>
      <td>225.0</td>
      <td>5400.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>299</th>
      <td>50.6</td>
      <td>19.4</td>
      <td>193.0</td>
      <td>3800.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>32</th>
      <td>39.5</td>
      <td>17.8</td>
      <td>188.0</td>
      <td>3300.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>19</th>
      <td>46.0</td>
      <td>21.5</td>
      <td>194.0</td>
      <td>4200.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>334</th>
      <td>50.2</td>
      <td>18.8</td>
      <td>202.0</td>
      <td>3800.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>188</th>
      <td>42.6</td>
      <td>13.7</td>
      <td>213.0</td>
      <td>4950.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>222</th>
      <td>47.7</td>
      <td>15.0</td>
      <td>216.0</td>
      <td>4750.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>105</th>
      <td>39.7</td>
      <td>18.9</td>
      <td>184.0</td>
      <td>3550.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>310</th>
      <td>49.7</td>
      <td>18.6</td>
      <td>195.0</td>
      <td>3600.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>41</th>
      <td>40.8</td>
      <td>18.4</td>
      <td>195.0</td>
      <td>3900.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>196</th>
      <td>50.5</td>
      <td>15.9</td>
      <td>222.0</td>
      <td>5550.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>71</th>
      <td>39.7</td>
      <td>18.4</td>
      <td>190.0</td>
      <td>3900.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>335</th>
      <td>45.6</td>
      <td>19.4</td>
      <td>194.0</td>
      <td>3525.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>118</th>
      <td>35.7</td>
      <td>17.0</td>
      <td>189.0</td>
      <td>3350.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>270</th>
      <td>47.2</td>
      <td>13.7</td>
      <td>214.0</td>
      <td>4925.0</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Adelie</th>
      <th>Chinstrap</th>
      <th>Gentoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>245</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>338</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>89</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>262</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>48</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>285</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>268</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>218</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>234</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>187</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>307 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Adelie</th>
      <th>Chinstrap</th>
      <th>Gentoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>333</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>112</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>239</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>269</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>311</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>219</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>278</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>161</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>84</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>173</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>119</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>235</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>80</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>255</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>122</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>72</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>216</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>199</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>299</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>334</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>188</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>222</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>105</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>310</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>196</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>71</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>335</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>118</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>270</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-01-09 07:27:03.676328: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">tensorflow.random</span> <span class="kn">import</span> <span class="n">set_seed</span>
<span class="n">set_seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">inputs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;KerasTensor: shape=(None, 5) dtype=float32 (created by layer &#39;input_1&#39;)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-01-09 07:27:06.498989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 20953 MB memory:  -&gt; device: 0, name: NVIDIA A10, pci bus id: 0000:61:00.0, compute capability: 8.6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">hidden_layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">output_layer</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;model&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 5)]               0         
                                                                 
 dense (Dense)               (None, 10)                60        
                                                                 
 dense_1 (Dense)             (None, 3)                 33        
                                                                 
=================================================================
Total params: 93 (372.00 Byte)
Trainable params: 93 (372.00 Byte)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">legacy</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span> <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">CategoricalCrossentropy</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/100
10/10 [==============================] - 0s 2ms/step - loss: 1015.4874
Epoch 2/100
10/10 [==============================] - 0s 2ms/step - loss: 884.8992
Epoch 3/100
10/10 [==============================] - 0s 2ms/step - loss: 761.2500
Epoch 4/100
10/10 [==============================] - 0s 2ms/step - loss: 643.1030
Epoch 5/100
10/10 [==============================] - 0s 2ms/step - loss: 535.1355
Epoch 6/100
10/10 [==============================] - 0s 2ms/step - loss: 457.2358
Epoch 7/100
10/10 [==============================] - 0s 2ms/step - loss: 378.4028
Epoch 8/100
 1/10 [==&gt;...........................] - ETA: 0s - loss: 378.2369
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-01-09 07:27:07.202523: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:606] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10/10 [==============================] - 0s 2ms/step - loss: 303.1219
Epoch 9/100
10/10 [==============================] - 0s 2ms/step - loss: 226.0870
Epoch 10/100
10/10 [==============================] - 0s 2ms/step - loss: 154.4714
Epoch 11/100
10/10 [==============================] - 0s 2ms/step - loss: 82.2054
Epoch 12/100
10/10 [==============================] - 0s 2ms/step - loss: 26.8942
Epoch 13/100
10/10 [==============================] - 0s 2ms/step - loss: 29.9371
Epoch 14/100
10/10 [==============================] - 0s 2ms/step - loss: 21.5699
Epoch 15/100
10/10 [==============================] - 0s 2ms/step - loss: 20.9316
Epoch 16/100
10/10 [==============================] - 0s 2ms/step - loss: 19.9883
Epoch 17/100
10/10 [==============================] - 0s 2ms/step - loss: 18.9656
Epoch 18/100
10/10 [==============================] - 0s 2ms/step - loss: 18.5297
Epoch 19/100
10/10 [==============================] - 0s 2ms/step - loss: 17.7819
Epoch 20/100
10/10 [==============================] - 0s 2ms/step - loss: 16.8236
Epoch 21/100
10/10 [==============================] - 0s 2ms/step - loss: 16.1105
Epoch 22/100
10/10 [==============================] - 0s 2ms/step - loss: 15.7117
Epoch 23/100
10/10 [==============================] - 0s 2ms/step - loss: 14.7285
Epoch 24/100
10/10 [==============================] - 0s 2ms/step - loss: 13.9431
Epoch 25/100
10/10 [==============================] - 0s 2ms/step - loss: 13.1817
Epoch 26/100
10/10 [==============================] - 0s 2ms/step - loss: 12.4109
Epoch 27/100
10/10 [==============================] - 0s 2ms/step - loss: 12.4272
Epoch 28/100
10/10 [==============================] - 0s 2ms/step - loss: 11.2461
Epoch 29/100
10/10 [==============================] - 0s 2ms/step - loss: 10.7755
Epoch 30/100
10/10 [==============================] - 0s 2ms/step - loss: 9.7845
Epoch 31/100
10/10 [==============================] - 0s 2ms/step - loss: 9.1328
Epoch 32/100
10/10 [==============================] - 0s 2ms/step - loss: 8.9986
Epoch 33/100
10/10 [==============================] - 0s 2ms/step - loss: 7.6808
Epoch 34/100
10/10 [==============================] - 0s 2ms/step - loss: 7.3601
Epoch 35/100
10/10 [==============================] - 0s 2ms/step - loss: 6.5697
Epoch 36/100
10/10 [==============================] - 0s 2ms/step - loss: 6.0516
Epoch 37/100
10/10 [==============================] - 0s 2ms/step - loss: 5.4636
Epoch 38/100
10/10 [==============================] - 0s 2ms/step - loss: 5.0098
Epoch 39/100
10/10 [==============================] - 0s 2ms/step - loss: 4.7890
Epoch 40/100
10/10 [==============================] - 0s 2ms/step - loss: 4.3679
Epoch 41/100
10/10 [==============================] - 0s 2ms/step - loss: 4.5915
Epoch 42/100
10/10 [==============================] - 0s 2ms/step - loss: 4.2618
Epoch 43/100
10/10 [==============================] - 0s 2ms/step - loss: 3.8259
Epoch 44/100
10/10 [==============================] - 0s 2ms/step - loss: 3.7209
Epoch 45/100
10/10 [==============================] - 0s 2ms/step - loss: 3.4403
Epoch 46/100
10/10 [==============================] - 0s 2ms/step - loss: 3.4103
Epoch 47/100
10/10 [==============================] - 0s 2ms/step - loss: 3.8025
Epoch 48/100
10/10 [==============================] - 0s 2ms/step - loss: 3.6355
Epoch 49/100
10/10 [==============================] - 0s 2ms/step - loss: 3.1812
Epoch 50/100
10/10 [==============================] - 0s 2ms/step - loss: 2.6628
Epoch 51/100
10/10 [==============================] - 0s 2ms/step - loss: 2.4035
Epoch 52/100
10/10 [==============================] - 0s 2ms/step - loss: 2.3838
Epoch 53/100
10/10 [==============================] - 0s 2ms/step - loss: 3.0629
Epoch 54/100
10/10 [==============================] - 0s 2ms/step - loss: 2.3382
Epoch 55/100
10/10 [==============================] - 0s 2ms/step - loss: 2.1033
Epoch 56/100
10/10 [==============================] - 0s 2ms/step - loss: 1.6672
Epoch 57/100
10/10 [==============================] - 0s 2ms/step - loss: 1.5632
Epoch 58/100
10/10 [==============================] - 0s 2ms/step - loss: 1.5092
Epoch 59/100
10/10 [==============================] - 0s 2ms/step - loss: 1.3471
Epoch 60/100
10/10 [==============================] - 0s 2ms/step - loss: 1.2847
Epoch 61/100
10/10 [==============================] - 0s 2ms/step - loss: 1.5229
Epoch 62/100
10/10 [==============================] - 0s 2ms/step - loss: 1.5827
Epoch 63/100
10/10 [==============================] - 0s 2ms/step - loss: 1.2878
Epoch 64/100
10/10 [==============================] - 0s 2ms/step - loss: 1.0977
Epoch 65/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1016
Epoch 66/100
10/10 [==============================] - 0s 2ms/step - loss: 1.2771
Epoch 67/100
10/10 [==============================] - 0s 2ms/step - loss: 1.5543
Epoch 68/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1844
Epoch 69/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1441
Epoch 70/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1843
Epoch 71/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1437
Epoch 72/100
10/10 [==============================] - 0s 2ms/step - loss: 1.0442
Epoch 73/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1147
Epoch 74/100
10/10 [==============================] - 0s 2ms/step - loss: 1.0953
Epoch 75/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1173
Epoch 76/100
10/10 [==============================] - 0s 2ms/step - loss: 1.0520
Epoch 77/100
10/10 [==============================] - 0s 2ms/step - loss: 1.0242
Epoch 78/100
10/10 [==============================] - 0s 2ms/step - loss: 1.0637
Epoch 79/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1284
Epoch 80/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1324
Epoch 81/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1172
Epoch 82/100
10/10 [==============================] - 0s 2ms/step - loss: 1.2402
Epoch 83/100
10/10 [==============================] - 0s 2ms/step - loss: 1.1240
Epoch 84/100
10/10 [==============================] - 0s 1ms/step - loss: 1.0794
Epoch 85/100
10/10 [==============================] - 0s 1ms/step - loss: 1.0693
Epoch 86/100
10/10 [==============================] - 0s 1ms/step - loss: 1.0898
Epoch 87/100
10/10 [==============================] - 0s 1ms/step - loss: 1.0458
Epoch 88/100
10/10 [==============================] - 0s 1ms/step - loss: 1.2224
Epoch 89/100
10/10 [==============================] - 0s 1ms/step - loss: 1.0337
Epoch 90/100
10/10 [==============================] - 0s 1ms/step - loss: 1.1267
Epoch 91/100
10/10 [==============================] - 0s 1ms/step - loss: 2.1266
Epoch 92/100
10/10 [==============================] - 0s 1ms/step - loss: 1.9268
Epoch 93/100
10/10 [==============================] - 0s 1ms/step - loss: 1.1867
Epoch 94/100
10/10 [==============================] - 0s 1ms/step - loss: 0.9464
Epoch 95/100
10/10 [==============================] - 0s 990us/step - loss: 1.4309
Epoch 96/100
10/10 [==============================] - 0s 1ms/step - loss: 1.1865
Epoch 97/100
10/10 [==============================] - 0s 996us/step - loss: 1.6076
Epoch 98/100
10/10 [==============================] - 0s 1ms/step - loss: 1.6465
Epoch 99/100
10/10 [==============================] - 0s 1ms/step - loss: 1.3923
Epoch 100/100
10/10 [==============================] - 0s 1ms/step - loss: 1.0014
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">history</span><span class="o">.</span><span class="n">epoch</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/927a575f84ddd64bb11d0f62f0d1a08f2bcbc1cd768f6f648e5ca6d11c472fc2.png" src="_images/927a575f84ddd64bb11d0f62f0d1a08f2bcbc1cd768f6f648e5ca6d11c472fc2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">prediction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/2 [==============================] - 0s 7ms/step
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Adelie</th>
      <th>Chinstrap</th>
      <th>Gentoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.648391e-01</td>
      <td>1.715673e-01</td>
      <td>6.359363e-02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.454711e-01</td>
      <td>4.545289e-01</td>
      <td>2.100461e-08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.833452e-09</td>
      <td>6.493035e-10</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.966254e-15</td>
      <td>1.784904e-15</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.872245e-01</td>
      <td>1.109848e-01</td>
      <td>1.790675e-03</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9.873828e-01</td>
      <td>1.261715e-02</td>
      <td>4.766879e-10</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.018278e-14</td>
      <td>5.001138e-14</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.829051e-01</td>
      <td>1.709081e-02</td>
      <td>3.938773e-06</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.619196e-08</td>
      <td>9.007781e-09</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7.116187e-01</td>
      <td>2.883812e-01</td>
      <td>1.857964e-07</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.152847e-07</td>
      <td>1.505111e-07</td>
      <td>9.999998e-01</td>
    </tr>
    <tr>
      <th>11</th>
      <td>9.103811e-01</td>
      <td>8.961879e-02</td>
      <td>3.948410e-08</td>
    </tr>
    <tr>
      <th>12</th>
      <td>5.516306e-11</td>
      <td>1.907833e-10</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>13</th>
      <td>6.351340e-01</td>
      <td>3.648659e-01</td>
      <td>1.353383e-08</td>
    </tr>
    <tr>
      <th>14</th>
      <td>8.191870e-01</td>
      <td>1.808130e-01</td>
      <td>1.281623e-09</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.306449e-12</td>
      <td>1.319104e-11</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>16</th>
      <td>9.992987e-01</td>
      <td>7.012586e-04</td>
      <td>1.666273e-09</td>
    </tr>
    <tr>
      <th>17</th>
      <td>5.740452e-01</td>
      <td>4.259438e-01</td>
      <td>1.094981e-05</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2.500658e-02</td>
      <td>6.073019e-03</td>
      <td>9.689205e-01</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2.341845e-06</td>
      <td>3.067315e-05</td>
      <td>9.999670e-01</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.879179e-11</td>
      <td>7.223661e-11</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>9.881677e-01</td>
      <td>1.179230e-02</td>
      <td>4.009461e-05</td>
    </tr>
    <tr>
      <th>22</th>
      <td>9.027959e-01</td>
      <td>9.720411e-02</td>
      <td>2.563040e-08</td>
    </tr>
    <tr>
      <th>23</th>
      <td>9.342888e-01</td>
      <td>1.061412e-02</td>
      <td>5.509710e-02</td>
    </tr>
    <tr>
      <th>24</th>
      <td>7.657505e-01</td>
      <td>2.333840e-01</td>
      <td>8.654961e-04</td>
    </tr>
    <tr>
      <th>25</th>
      <td>3.820047e-07</td>
      <td>4.642012e-07</td>
      <td>9.999992e-01</td>
    </tr>
    <tr>
      <th>26</th>
      <td>4.629333e-06</td>
      <td>1.199403e-05</td>
      <td>9.999834e-01</td>
    </tr>
    <tr>
      <th>27</th>
      <td>9.900614e-01</td>
      <td>9.938368e-03</td>
      <td>2.153488e-07</td>
    </tr>
    <tr>
      <th>28</th>
      <td>9.464169e-01</td>
      <td>5.357845e-02</td>
      <td>4.640924e-06</td>
    </tr>
    <tr>
      <th>29</th>
      <td>8.868090e-01</td>
      <td>1.114146e-01</td>
      <td>1.776450e-03</td>
    </tr>
    <tr>
      <th>30</th>
      <td>6.899412e-12</td>
      <td>5.361637e-12</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>31</th>
      <td>9.746879e-01</td>
      <td>2.498482e-02</td>
      <td>3.272409e-04</td>
    </tr>
    <tr>
      <th>32</th>
      <td>8.940583e-01</td>
      <td>1.059394e-01</td>
      <td>2.274549e-06</td>
    </tr>
    <tr>
      <th>33</th>
      <td>7.915920e-01</td>
      <td>2.084079e-01</td>
      <td>1.082515e-07</td>
    </tr>
    <tr>
      <th>34</th>
      <td>9.376542e-07</td>
      <td>6.750374e-07</td>
      <td>9.999983e-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_species</span> <span class="o">=</span> <span class="n">prediction</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">predicted_species</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     Adelie
1     Adelie
2     Gentoo
3     Gentoo
4     Adelie
5     Adelie
6     Gentoo
7     Adelie
8     Gentoo
9     Adelie
10    Gentoo
11    Adelie
12    Gentoo
13    Adelie
14    Adelie
15    Gentoo
16    Adelie
17    Adelie
18    Gentoo
19    Gentoo
20    Gentoo
21    Adelie
22    Adelie
23    Adelie
24    Adelie
25    Gentoo
26    Gentoo
27    Adelie
28    Adelie
29    Adelie
30    Gentoo
31    Adelie
32    Adelie
33    Adelie
34    Gentoo
dtype: category
Categories (3, object): [&#39;Adelie&#39;, &#39;Chinstrap&#39;, &#39;Gentoo&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">true_species</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>

<span class="n">matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">true_species</span><span class="p">,</span> <span class="n">predicted_species</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[14  0  1]
 [ 7  0  0]
 [ 0  0 13]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to a pandas dataframe</span>
<span class="n">confusion_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">y_test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">y_test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># Set the names of the x and y axis, this helps with the readability of the heatmap.</span>
<span class="n">confusion_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;True Label&#39;</span>
<span class="n">confusion_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Predicted Label&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_df</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Predicted Label&#39;, ylabel=&#39;True Label&#39;&gt;
</pre></div>
</div>
<img alt="_images/cc078bcfe89ee551aea2658c1592e12aa139108f8538e2f759ea59f7f243c096.png" src="_images/cc078bcfe89ee551aea2658c1592e12aa139108f8538e2f759ea59f7f243c096.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_first_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:tensorflow:Assets written to: my_first_model/assets
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:tensorflow:Assets written to: my_first_model/assets
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pretrained_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;my_first_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the pretrained model here</span>
<span class="n">y_pretrained_pred</span> <span class="o">=</span> <span class="n">pretrained_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">pretrained_prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_pretrained_pred</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># idxmax will select the column for each row with the highest value</span>
<span class="n">pretrained_predicted_species</span> <span class="o">=</span> <span class="n">pretrained_prediction</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pretrained_predicted_species</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/2 [==============================] - 0s 2ms/step
0     Adelie
1     Adelie
2     Gentoo
3     Gentoo
4     Adelie
5     Adelie
6     Gentoo
7     Adelie
8     Gentoo
9     Adelie
10    Gentoo
11    Adelie
12    Gentoo
13    Adelie
14    Adelie
15    Gentoo
16    Adelie
17    Adelie
18    Gentoo
19    Gentoo
20    Gentoo
21    Adelie
22    Adelie
23    Adelie
24    Adelie
25    Gentoo
26    Gentoo
27    Adelie
28    Adelie
29    Adelie
30    Gentoo
31    Adelie
32    Adelie
33    Adelie
34    Gentoo
dtype: category
Categories (3, object): [&#39;Adelie&#39;, &#39;Chinstrap&#39;, &#39;Gentoo&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="exercises.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Try it out yourself</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-use-the-penguin-dataset-to-train-a-neural-network-which-can-classify-which-species-a-penguin-belongs-to-based-on-their-physical-characteristics">¶We will use the penguin dataset to train a neural network which can classify which species a penguin belongs to, based on their physical characteristics.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspired-from-https-carpentries-incubator-github-io-deep-learning-intro-02-keras-index-html-and-https-github-com-mcnakhaee-palmerpenguins">(inspired from https://carpentries-incubator.github.io/deep-learning-intro/02-keras/index.html and https://github.com/mcnakhaee/palmerpenguins)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Anne Fouilloux (Simula, NO)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>